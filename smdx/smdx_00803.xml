<sunSpecModels v="1">

  <!-- 803: Lithium-Ion Battery Model -->
  <model id="803" len="33" name="lithium_ion_bank">
    <block len="12">
      <point id="BConStrCt" offset="0" type="uint16" mandatory="true" />
      <point id="BMaxModTmp" offset="1" type="int16" sf="BModTmp_SF" units="" mandatory="true" />
      <point id="BMaxModTmpLoc" offset="2" type="uint16" />
      <point id="BMinModTmp" offset="3" type="int16" sf="BModTmp_SF" units="C" mandatory="true" />
      <point id="BMinModTmpLoc" offset="4" type="uint16" />
      <point id="BMaxStrCur" offset="5" type="int16" sf="BCurrent_SF" units="A" />
      <point id="BMinStrCur" offset="6" type="int16" sf="BCurrent_SF" units="A" />
      <point id="BCellBalCt" offset="7" type="uint16" mandatory="false" />
      <point id="BCellVol_SF" offset="8" type="sunssf" mandatory="true" />
      <point id="BModTmp_SF" offset="9" type="sunssf" mandatory="true" />
      <point id="BCurrent_SF" offset="10" type="sunssf" mandatory="true" />
      <point id="StrSoH_SF" offset="11" type="sunssf" />
    </block>
    <block type="repeating" len="21" name="module">
      <point id="StrModCt" offset="0" type="uint16" mandatory="true" />
      <point id="StrStatus" offset="1" type="bitfield32" mandatory="true">
        <symbol id="STRING_ENABLED">0</symbol>
        <symbol id="CONTACTOR_STATUS">1</symbol>
      </point>
      <point id="StrSoC" offset="2" type="uint16" units="%" mandatory="true" />
      <point id="StrSoH" offset="3" type="uint16" sf="StrSoH_SF" units="%" />
      <point id="StrCur" offset="4" type="int16" sf="BCurrent_SF" units="A" mandatory="true" />
      <point id="StrMaxCellVol" offset="5" type="uint16" sf="BCellVol_SF" units="V" mandatory="true" />
      <point id="StrMinCellVol" offset="6" type="uint16" sf="BCellVol_SF" units="V" mandatory="true" />
      <point id="StrCellVolLoc" offset="7" type="uint16" />
      <point id="StrMaxModTmp" offset="8" type="int16" sf="BModTmp_SF" units="C" mandatory="true" />
      <point id="StrMinModTmp" offset="9" type="int16" sf="BModTmp_SF" units="C" mandatory="true" />
      <point id="StrModTmpLoc" offset="10" type="uint16" />
      <point id="StrEvt1" offset="11" type="bitfield32" mandatory="true" >
        <symbol id="COMMUNICATION_ERROR">0</symbol>
        <symbol id="OVER_TEMP_ALARM">1</symbol>
        <symbol id="OVER_TEMP_WARNING">2</symbol>
        <symbol id="UNDER_TEMP_ALARM">3</symbol>
        <symbol id="UNDER_TEMP_WARNING">4</symbol>
        <symbol id="OVER_CHARGE_CURRENT_ALARM">5</symbol>
        <symbol id="OVER_CHARGE_CURRENT_WARNING">6</symbol>
        <symbol id="OVER_DISCHARGE_CURRENT_ALARM">7</symbol>
        <symbol id="OVER_DISCHARGE_CURRENT_WARNING">8</symbol>
        <symbol id="OVER_VOLT_ALARM">9</symbol>
        <symbol id="OVER_VOLT_WARNING">10</symbol>
        <symbol id="UNDER_VOLT_ALARM">11</symbol>
        <symbol id="UNDER_VOLT_WARNING">12</symbol>
        <symbol id="UNDER_SOC_MIN_ALARM">13</symbol>
        <symbol id="UNDER_SOC_MIN_WARNING">14</symbol>
        <symbol id="OVER_SOC_MAX_ALARM">15</symbol>
        <symbol id="OVER_SOC_MAX_WARNING">16</symbol>
        <symbol id="VOLTAGE_IMBALANCE_WARNING">17</symbol>
        <symbol id="CURRENT_IMBALANCE_WARNING">18</symbol>
        <symbol id="CONTACTOR_ERROR">19</symbol>
        <symbol id="FAN_ERROR">20</symbol>
        <symbol id="GROUND_FAULT">21</symbol>
        <symbol id="OPEN_DOOR_ERROR">22</symbol>
      </point>
      <point id="StrEvt2" offset="13" type="bitfield32" />
      <point id="StrEvtOtherAlarm" offset="15" type="bitfield32" />
      <point id="StrEvtOtherWarning" offset="17" type="bitfield32" />
      <point id="StrConFail" offset="19" type="enum16" >
        <symbol id="NO_FAILURE">0</symbol>
        <symbol id="BUTTON_PUSHED">1</symbol>
        <symbol id="STR_GROUND_FAULT">2</symbol>
        <symbol id="OUTSIDE_VOLTAGE_RANGE">3</symbol>
      </point>
      <point id="StrSetEna" offset="20" access="rw" type="enum16" mandatory="false">
        <symbol id="ENABLE_STRING">1</symbol>
        <symbol id="DISABLE_STRING">2</symbol>
      </point>
    </block>
  </model>
  <strings id="803" locale="en">
    <model>
      <label>Lithium-Ion Battery Bank Model</label>
      <description></description>
      <notes></notes>
    </model>
    <point id="BConStrCt">
      <label>Connected String Count</label>
      <description>Number of strings with contactor closed.</description>
      <notes></notes>
    </point>
    <point id="BMaxModTmp">
      <label>Max Module Temp</label>
      <description>Maximum temperature for all modules in the bank.</description>
      <notes>Measurement</notes>
    </point>
    <point id="BMaxModTmpLoc">
      <label>Max Module Temp Location</label>
      <description>Location of the module with max temperature.</description>
      <notes>Bit0:Bit7 = String Number  Bit8:Bit15 = Module Number</notes>
    </point>
    <point id="BMinModTmp">
      <label>Min Module Temp</label>
      <description>Minimum temperature for all modules in the bank.</description>
      <notes>Measurement</notes>
    </point>
    <point id="BMinModTmpLoc">
      <label>Min Module Temp Location</label>
      <description>Location of the module with min temperature.</description>
      <notes>Bit0:Bit7 = String Number  Bit8:Bit15 = Module Number</notes>
    </point>
    <point id="BMaxStrCur">
      <label>Max String Current</label>
      <description>Maximum current of any string in the bank.</description>
      <notes>Measurement</notes>
    </point>
    <point id="BMinStrCur">
      <label>Min String Current</label>
      <description>Minimm current of any string in the bank.</description>
      <notes>Measurement</notes>
    </point>
    <point id="BCellBalCt">
      <label>Battery Cell Balancing Count</label>
      <description>Total count of cells that are currently being balanced.</description>
      <notes></notes>
    </point>
    <point id="BCellVol_SF">
      <label></label>
      <description>Scale factor for cell voltage.</description>
      <notes></notes>
    </point>
    <point id="BModTmp_SF">
      <label></label>
      <description>Scale factor for module temperatures.</description>
      <notes></notes>
    </point>
    <point id="BCurrent_SF">
      <label></label>
      <description>Scale factor for Max String Current and Min String Current.</description>
      <notes></notes>
    </point>
    <point id="StrSoH_SF">
      <label></label>
      <description>Scale factor for String State of Health.</description>
      <notes></notes>
    </point>
    <point id="StrModCt">
      <label>Module Count</label>
      <description>Count of modules in the string.</description>
      <notes></notes>
    </point>
    <point id="StrStatus">
      <label>String Status</label>
      <description>Current status of the string.</description>
      <notes></notes>
      <symbol id="STRING_ENABLED">
        <label>String Is Enabled</label>
        <description>String is enabled and will connect next time battery is asked to connect.</description>
        <notes></notes>
      </symbol>
      <symbol id="CONTACTOR_STATUS">
        <label>Contactor Status</label>
        <description>String contactor is closed.</description>
        <notes></notes>
      </symbol>
    </point>
    <point id="StrSoC">
      <label>String SoC</label>
      <description>Battery string state of charge, expressed as a percentage.</description>
      <notes>Measurement</notes>
    </point>
    <point id="StrSoH">
      <label>String SoH</label>
      <description>Battery string state of health, expressed as a percentage.</description>
      <notes>Measurement</notes>
    </point>
    <point id="StrCur">
      <label>String Current</label>
      <description>String current measurement.</description>
      <notes>Measurement</notes>
    </point>
    <point id="StrMaxCellVol">
      <label>Max Cell Voltage</label>
      <description>Maximum voltage for all cells in the string.</description>
      <notes>Measurement</notes>
    </point>
    <point id="StrMinCellVol">
      <label>Min Cell Voltage</label>
      <description>Minimum voltage for all cells in the string.</description>
      <notes>Measurement</notes>
    </point>
    <point id="StrCellVolLoc">
      <label>Max/Min Cell Voltage Loc</label>
      <description>Location of maximum and minimum cell voltages.</description>
      <notes>Bit0:Bit7 = Max Module Num  Bit8:Bit15 = Min Module Num</notes>
    </point>
    <point id="StrMaxModTmp">
      <label>Max Module Temp</label>
      <description>Maximum temperature for all modules in the bank.</description>
      <notes>Measurement</notes>
    </point>
    <point id="StrMinModTmp">
      <label>Min Module Temp</label>
      <description>Minimum temperature for all modules in the bank.</description>
      <notes>Measurement</notes>
    </point>
    <point id="StrModTmpLoc">
      <label>Max/Min Mod Temp Loc</label>
      <description>Location of maximum and minimum module temperatures.</description>
      <notes>Bit0:Bit7 = Max Module Num  Bit8:Bit15 = Min Module Num</notes>
    </point>
    <point id="StrEvt1">
      <label>String Event 1</label>
      <description>Alarms, warnings and status values.  Bit flags.</description>
      <notes></notes>
      <symbol id="COMMUNICATION_ERROR">
        <label>Communication Error</label>
        <description>String is unable to communicate with battery modules.</description>
        <notes></notes>
      </symbol>
      <symbol id="OVER_TEMP_ALARM">
        <label>Over Temperature Alarm</label>
        <description>Battery string has exceeded maximum operating temperature</description>
        <notes></notes>
      </symbol>
      <symbol id="OVER_TEMP_WARNING">
        <label>Over Temperature  Warning</label>
        <description>Battery string is approaching maximum operating temperature.</description>
        <notes></notes>
      </symbol>
      <symbol id="UNDER_TEMP_ALARM">
        <label>Under Temperature Alarm</label>
        <description>Battery string has exceeded minimum operating temperature</description>
        <notes></notes>
      </symbol>
      <symbol id="UNDER_TEMP_WARNING">
        <label>Under Temperature Warning</label>
        <description>Battery string is approaching minimum operating temperature.</description>
        <notes></notes>
      </symbol>
      <symbol id="OVER_CHARGE_CURRENT_ALARM">
        <label>Over Charge Current Alarm</label>
        <description>Battery string maximum charge current has been exceeded.</description>
        <notes>See AMaxCha</notes>
      </symbol>
      <symbol id="OVER_CHARGE_CURRENT_WARNING">
        <label>Over Charge Current Warning</label>
        <description>Approaching battery string maximum charge current.</description>
        <notes>See AMaxCha</notes>
      </symbol>
      <symbol id="OVER_DISCHARGE_CURRENT_ALARM">
        <label>Over Discharge Current Alarm</label>
        <description>Battery string maximum discharge current has been exceeded.</description>
        <notes>See AMaxDischa</notes>
      </symbol>
      <symbol id="OVER_DISCHARGE_CURRENT_WARNING">
        <label>Over Discharge Current Warning</label>
        <description>Approaching battery string maximum discharge current.</description>
        <notes>See AMaxDischa</notes>
      </symbol>
      <symbol id="OVER_VOLT_ALARM">
        <label>Over Voltage Alarm</label>
        <description>Battery string voltage has exceeded maximum limit.</description>
        <notes></notes>
      </symbol>
      <symbol id="OVER_VOLT_WARNING">
        <label>Over Voltage Warning</label>
        <description>Battery string voltage is approaching maximum limit.</description>
        <notes></notes>
      </symbol>
      <symbol id="UNDER_VOLT_ALARM">
        <label>Under Voltage Alarm</label>
        <description>Battery string voltage has exceeded minimum limit.</description>
        <notes></notes>
      </symbol>
      <symbol id="UNDER_VOLT_WARNING">
        <label>Under Voltage Warning</label>
        <description>Battery string voltage is approaching minimum limit.</description>
        <notes></notes>
      </symbol>
      <symbol id="UNDER_SOC_MIN_ALARM">
        <label>Under State of Charge Minimum Alarm</label>
        <description>Battery string state of charge has reached or exceeded SoCNpMinPct</description>
        <notes></notes>
      </symbol>
      <symbol id="UNDER_SOC_MIN_WARNING">
        <label>Under State of Charge Minimum Warning</label>
        <description>Battery string state of charge is approaching SoCNpMinPct</description>
        <notes></notes>
      </symbol>
      <symbol id="OVER_SOC_MAX_ALARM">
        <label>Over State of Charge Maximum Warning</label>
        <description>Battery string state of charge has reached or exceeded SocNpMaxPct</description>
        <notes></notes>
      </symbol>
      <symbol id="OVER_SOC_MAX_WARNING">
        <label>Over State of Charge Maximum Warning</label>
        <description>Battery string state of charge is approaching SoCNpMaxPct</description>
        <notes></notes>
      </symbol>
      <symbol id="VOLTAGE_IMBALANCE_WARNING">
        <label>Voltage Imbalance Warning</label>
        <description>A voltage imbalance exists between the modules in the battery string.</description>
        <notes></notes>
      </symbol>
      <symbol id="CURRENT_IMBALANCE_WARNING">
        <label>Current Imbalance Warning</label>
        <description>A current imbalance exists in the battery string.</description>
        <notes></notes>
      </symbol>
      <symbol id="CONTACTOR_ERROR">
        <label>Contactor Error</label>
        <description>A contactor failed to open or close as requested.</description>
        <notes></notes>
      </symbol>
      <symbol id="FAN_ERROR">
        <label>Fan Error</label>
        <description>One or more battery fans has failed.</description>
        <notes></notes>
      </symbol>
      <symbol id="GROUND_FAULT">
        <label>Ground Fault Error</label>
        <description>Ground fault detected.</description>
        <notes></notes>
      </symbol>
      <symbol id="OPEN_DOOR_ERROR">
        <label>Open Door Error</label>
        <description>One or more doors are open.</description>
        <notes></notes>
      </symbol>
    </point>
    <point id="StrEvt2">
      <label>String Event 2</label>
      <description>Alarms, warnings and status values.  Bit flags.</description>
      <notes>Reserved for future use.</notes>
    </point>
    <point id="StrEvtOtherAlarm">
      <label>Other String Alarm Events</label>
      <description>Other string alarms.  Bit flags.</description>
      <notes>Bits are vendor specific and not defined by MESA.</notes>
    </point>
    <point id="StrEvtOtherWarning">
      <label>Other String Warning Events</label>
      <description>Other string warnings.  Bit flags.</description>
      <notes>Bits are vendor specific and not defined here.</notes>
    </point>
    <point id="StrConFail">
      <label>Connection Failure Reason</label>
      <description></description>
      <notes></notes>
      <symbol id="NO_FAILURE">
        <label>No Failure</label>
        <description>Connect did not fail.</description>
        <notes></notes>
      </symbol>
      <symbol id="BUTTON_PUSHED">
        <label>Button Pushed</label>
        <description>A button was pushed which prevented connection.</description>
        <notes></notes>
      </symbol>
      <symbol id="STR_GROUND_FAULT">
        <label>Ground Fault</label>
        <description>Ground fault during auto-connect.</description>
        <notes></notes>
      </symbol>
      <symbol id="OUTSIDE_VOLTAGE_RANGE">
        <label>Outside Voltage Range</label>
        <description>Outside voltage target window during auto-connect.</description>
        <notes></notes>
      </symbol>
    </point>
    <point id="StrSetEna">
      <label>Enable/Disable String</label>
      <description>Enables and disables the string.  Should reset to 0 upon completion.</description>
      <notes></notes>
      <symbol id="ENABLE_STRING">
        <label>Enable String</label>
        <description>Enable the string.</description>
        <notes></notes>
      </symbol>
      <symbol id="DISABLE_STRING">
        <label>Disable String</label>
        <description>Disable the string.</description>
        <notes></notes>
      </symbol>
    </point>
   </strings>
</sunSpecModels>
